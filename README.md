# Настроения на рынке
Целью данного проекта - создание системы, которая оценивает
эмоциональные настроения на рынке на основе анализа новостей 
конкретной компании. 
Пример работы системы показан на картинке ниже, взаимодействие с пользователем
реализовано через интерфейс телеграм.

<image src="pictures/main.png">

"Под капотом" системы есть 2 нейросети. 
* 1-ая - делает сентиментальный анализ новостей.
* 2-ая - делаает анализ эмоциональной окраски новостей.

Схематичное изображение алгоритма работы системы показано ниже.

<image src="pictures/architecture.png">

Алгоритм работы следующий:
1. На вход подается определеное кол-во новостей,
связанных с компанией. В реализации берется 5.
2. Для каждой из новостей делается сентиментальный анализ.
Результат будет находиться в пределах от 0 до 10.
0- Хорошо,
1- Плохо. 
3. Вычисляется средняя сентиментальная оценка всех новостей и в качестве
результата сентиментального анализа выбирается новость, наиболее близкая к средней
оценке.
4. Для полученной на предыдущем шаге новости производится оценка эмоциональной
окраски.
5. На выходе получаем новость + смайлик , означающий эмоциональную окраску.

## Датасеты

1. Для сентиментального анализа использовался датасет IMDB. Распределение классов
в нем показано на рисунке ниже.

<image src="pictures/imdb_dataset.png">

2. Для эмоциональной классификации использовался датасет, который можно скачать по ссылке:
https://www.kaggle.com/code/shtrausslearning/twitter-emotion-classification
С помощью данного датасета можно добиться классификации на 6 эмоций.
Распределение классов в нем приведено ниже.

<image src="pictures/emotion_dataset.png">

## Архитектуры
### Сентиментальный анализ 
Программный код архитектуры для сентиментального анализа приведен на рисунке ниже.

<image src="pictures/sentiment_classification.png">

Первым идет слой эмбеддингов, далее последовательность из 
LSTM яйчеек, на выходе 1 нейрон с функцией активации sigmoid.

Для оценки точности нейросети использовалась бинарная кроссэнтропия.
Результаты проверки точности можно увидеть ниже.

<image src="pictures/sentiment_accuracy.png">

### Эмоциональная классификация

Архитектура в программном коде имеет следующий вид:

<image src="pictures/emotion_classification.png">

Архитектура нейросетти аналогична предыдущей нейросети, но в данном
случае происходит классификация по 6 классам.
Результаты проверки точности приведены на рисунке ниже.
<image src="pictures/amotion_accuracy.png">

## MVP

Ниже приведены результаты тестирования системы

<image src="pictures/mvp.png">
